module IQRF.DPA.MessageSpec where

import Test.Hspec
import Test.HUnit
import IQRF.DPA.Message

spec :: Spec
spec = do
  describe "Request" $ do
    it "should be writable to buffer" $ do
      let req = Request 0x0001 0x5E 0x00 0x0402 [0x02, 0x00, 0x00, 0x00]
      let buf = [0x01, 0x00, 0x5E, 0x00, 0x02, 0x04, 0x02, 0x00, 0x00, 0x00]
      toBuffer req @?= buf

  describe "Response" $ do
    it "should be readable from buffer" $ do
      let buf = [0x01, 0x00, 0x5E, 0x80, 0x02, 0x04, 0x00, 0x53, 0x6C]
      let res = Response 0x0001 0x5E 0x80 0x0402 0x00 0x53 [0x6C]
      fromBuffer buf @?= Just res
