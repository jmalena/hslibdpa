module IQRF.DPASpec where

import Test.Hspec
import Test.HUnit

import IQRF.DPA
import IQRF.DPA.Internal.Message

spec :: Spec
spec = do
  describe "makeFrcSendRequest" $ do
    it "should make valid request" $ do
      let req1 = makeFrcSendRequest 0xFFFF 0xC0 [0xAB, 0xCD]
      let req2 = Request 0x0000 0x0D 0x00 0xFFFF [0xC0, 0xAB, 0xCD]
      req1 @?= req2

  describe "makeFrcSendSelectiveRequest" $ do
    it "should make valid request" $ do
      let req1 = makeFrcSendSelectiveRequest 0xFFFF 0xC0 [0x0001, 0x0009, 0x000A] [0xAB, 0xCD]
      let req2 = Request 0x0000 0x0D 0x02 0xFFFF [0xC0, 0x01, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xAB, 0xCD]
      req1 @?= req2
